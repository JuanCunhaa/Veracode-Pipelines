trigger:
  branches:
    include:
      - main

pool:
  vmImage: 'ubuntu-22.04'

variables:
  - group: VeracodeSecrets # Nome do variable group aqui

stages:
  - stage: AutoPackager
    displayName: 'ðŸ“¦ Veracode AutoPackager'
    jobs:
      - job: package
        displayName: 'Gerar analysisPack.zip'
        steps:
          - checkout: self

          - bash: |
              set -e
              echo "ðŸ“¦ Instalando Veracode CLI..."
              curl -fsS https://tools.veracode.com/veracode-cli/install | sh

              echo "ðŸ“¦ Gerando analysisPack.zip via Veracode CLI..."
              ./veracode package \
                --source . \
                --output "CAMINHO-DO-ARTEFATO" \ # Aqui Ã© onde fica o arquivo final pÃ³s packager
                --trust \
                --verbose
            displayName: 'Executar Veracode AutoPackager'
